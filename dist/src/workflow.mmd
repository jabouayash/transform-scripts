%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#003366', 'primaryTextColor': '#fff', 'primaryBorderColor': '#003366', 'lineColor': '#595959', 'secondaryColor': '#f2f2f2', 'tertiaryColor': '#fff'}}}%%
flowchart LR
    subgraph INPUT["ğŸ“§ Incoming Emails"]
        E1["Custom Daily<br/>Portfolio Report"]
        E2["Daily Reports"]
    end

    subgraph OUTLOOK["ğŸ“¬ Outlook Monitor"]
        O1["Detects emails<br/>by subject"]
        O2["Saves attachments<br/>to Incoming folder"]
        O3["Triggers Excel<br/>when both arrive"]
    end

    subgraph EXCEL["ğŸ“Š Excel Transformer"]
        X1["Reads position data<br/>from Custom file"]
        X2["Reads YTD return<br/>from Daily file"]
        X3["Transforms &<br/>formats data"]
    end

    subgraph OUTPUT["ğŸ“ Output Report"]
        R1["Dashboard<br/>KPIs & Charts"]
        R2["Stocks Tab<br/>Formatted positions"]
        R3["Options Tab<br/>Puts & Calls"]
    end

    E1 --> O1
    E2 --> O1
    O1 --> O2
    O2 --> O3
    O3 --> X1
    O3 --> X2
    X1 --> X3
    X2 --> X3
    X3 --> R1
    X3 --> R2
    X3 --> R3
